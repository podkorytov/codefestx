<loader
  [isReady]="isReady">

  <layout
    [title]="'Расписание'">

    <!-- Actions -->
    <layout-actions
      actions
      [searchText]="searchText"
      [isSearchMode]="isSearchMode"
      (onSearch)="onSearch($event)"
      (onSearchModeChange)="onSearchModeChange($event)"
      (onFilter)="onFilter()">
    </layout-actions>


    <!-- Tags -->
    <div
      pre-content
      class="tags">

      <!-- Buttons group -->
      <div
        (click)="onShowAllClick()"
        [class.buttons-group--selected]="isShowAllVisible"
        class="tags__item buttons-group">

        <!-- Filters -->
        <button
          cf-button
          class="button-tag button-icon-only">

          <svg
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="24" height="24" viewBox="0 0 24 24"
            class="button-icon">
            <path d="M5 6h14a1 1 0 0 1 0 2H5a1 1 0 1 1 0-2zm3 5h8a1 1 0 0 1 0 2H8a1 1 0 0 1 0-2zm3 5h2a1 1 0 0 1 0 2h-2a1 1 0 0 1 0-2z" fill-rule="evenodd"/>
          </svg>
        </button>

        <!-- All -->
        <button
          cf-button
          class="button-tag">
          Все
        </button>
      </div>

      <button
        cf-button
        (click)="onShowFavoriteClick()"
        [class.button-primary]="isFavoriteVisible"
        class="tags__item button-tag">
        Избранные
      </button>

      <button
        *ngFor="let section of sections"
        cf-button
        (click)="onShowSectionClick(section)"
        [class.button-primary]="isShowSectionVisible(section)"
        class="tags__item button-tag">
        {{ section.title }}
      </button>
    </div>

    <!-- Content -->
    <div
      content>
      <!-- Schedule -->
      <div
        *ngIf="lectures.isEmpty"
        class="empty-lecture">
        Пока ничего нет. Жми звезду -- создавай свой CodeFestX
      </div>

      <div
        class="schedule">

        <template
          ngFor let-lecture [ngForOf]="lectures" let-i="index">

          <div
            *ngIf="isDayVisible(lecture, i)">

            {{ getDay(lecture.startTime) }}
          </div>

          <div
            class="schedule__event event">

            <!-- Time -->
            <div
              class="event__time">

              <template
                [ngIf]="isTimeVisible(lecture, i)">

                <!-- Start -->
                <time
                  class="event__time-item event__time-item--start"
                  [class.right_now]="isRightNow(lecture)"
                  [class.finished]="isFinished(lecture)">
                  {{ startTime(lecture) }}
                </time>

                <!-- End -->
                <time
                  class="event__time-item">
                  {{ endTime(lecture) }}
                </time>
              </template>
            </div>

            <!-- Info (todo details)-->
            <article
              (click)="onLectureSelect(lecture)"
              class="event__info event-card">

              <!-- Meta -->
              <div
                class="event-card__meta">

                <!-- Location -->
                <span
                  class="event-card__meta-item">
                {{ lecture.location.title }}
              </span>

                <!-- Section -->
                <span
                  class="event-card__meta-item">
                {{ lecture.section.title }}
              </span>

                <!--{{ flag(lecture) }}-->
              </div>

              <!-- Title -->
              <h1
                class="event-card__title">
                {{ lecture.title }}
              </h1>

              <!-- Speakers (todo: info item) -->
              <div
                class="event-card__speakers info-item">

                <!-- Media -->
                <div
                  class="info-item__media">

                <span
                  *ngFor="let speaker of lecture.speakers"
                  class="info-item__media-container">

                  <img
                    [src]="speaker.avatarPath"
                    [alt]="speaker.name"
                    class="info-item__media-image">
                </span>
                </div>

                <!-- Details -->
                <div
                  class="info-item__details">

                  <!-- Title -->
                  <div
                    class="info-item__title">

                    <ng-container
                      *ngFor="let speaker of lecture.speakers">
                      {{ speaker.name }}
                    </ng-container>
                  </div>

                  <!-- Subtitle -->
                  <div
                    class="info-item__subtitle">

                    <ng-container
                      *ngFor="let speaker of lecture.speakers">
                      {{ speaker.company }}
                    </ng-container>
                  </div>
                </div>
              </div>

              <ng-container
                *ngFor="let speaker of lecture.speakers; let i = index">

                <div
                  *ngIf="lecture.speakers.length == i + 1"
                  class="event-card__actions">

                  <actions
                    [popularity]="lecture.likesCount"
                    [isFavorite]="isFavoriteLecture(lecture)"
                    (onFavoriteChange)="onFavoriteChange(lecture, $event)">
                  </actions>
                </div>
              </ng-container>
            </article>
          </div>
        </template>
      </div>
    </div>
  </layout>
</loader>
